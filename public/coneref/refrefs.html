<html>
  <head>
	  <title>Region-Managed References - Cone Reference</title>
		<meta content="text/html; charset=UTF-8" http-equiv="content-type">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
	  <link rel="stylesheet" type="text/css" href="standard.css" />
	</head>
  <body>
		<div id="header">
			<a href="/"><div id="title">Cone</div></a>
			<div id="sub">Region-Managed References</div>
		</div>

    <div class="text">

	<p>In addition to borrowed-references, Cone also supports region-managed references.
		Region-managed references are like borrowed references in that they are
		pointers to values. They also support permissions: both static and lock.</p>
	<p>The difference is every region-managed reference belongs to a memory region which manages
		the ways its values are allocated and freed. By contrast, a borrowed reference does not care
		which memory region holds the values it points to.</p>

	<h2>What is a Region?</h2>
	<p>Imagine that a program's memory is conceptually partitioned into regions,
			each with its own strategy for allocating and reclaiming memory for values.
			Every program value is wholly located within and governed by its owning region.</p>
	<p>By way of illustration (even though we have not said so until now), the memory space for every
		variable's value is automatically allocated in one of these regions:</p>
	<ul>
		<li><b>Global region</b>.
			All global variable values are stored at fixed locations in the global region.</li>
		<li><b>Execution Stack regions</b>.
			Local variable values are allocated and de-allocated in LIFO order from a stack region
			as execution unfolds.
			Each execution thread has its own stack region.</li>
	</ul>
	<p>In addition to these built-in regions, we also need the ability to dynamically allocate heap memory
		for objects that are not convenient to hold on the stack.
		This is what Cone's regions accomplish: every region provides the ability to dynamically
		allocate new object values within its memory region and then safely free allocated objects
		when it is no longer needed.</p>
	<p>The reason Cone supports multiple regions is because there
		is no one perfect strategy for allocating and automatically freeing memory.
		Each strategy (e.g., tracing GC, ref-counting, single-owner, pools or arenas) carries
		different trade-offs in terms of throughput, latency/responsiveness, memory use and leakage, 
		data structure flexibility, and programmer convenience.</p>
	<p>Instead of restricting a program to the limitations of only one memory management strategy,
		as most languages do, Cone dynamically partitions memory into <b>regions</b>,
		each with its own approach to memory allocation and collection.
		For every new data object, Cone allows the programmer to specify, at allocation time,
		which region the object belongs to,
		according to how well it matches the object's usage profile.</p>

	<h2>Owning vs. Weak References</h2>
	<p>There are two kinds of region-managed references:  owning and weak.</p>
	<ul>
	<li><b><a href="refallocref.html">Owning references</a></b>.
		When you allocate a new value within a region, you get back an owning reference that points to the new object.
		For some regions, multiple alias copies may be created which are also owning references.
		For safety reasons, a region's automatic memory management strategy ensures that the
		object's memory is freed only when when the last owning reference to the object expires.
		This timing ensures that an owning reference is always safe to de-reference
		and that an object will only be freed once.</li>
	<li><b><a href="refweakref.html">Weak references</a></b>.
		A weak reference points to an object that may or may not still exist in the region's memory
		(unlike an owning reference that guarantees the object it points to is still alive).
		Before we can de-reference a weak reference, we first need to confirm it still exists.</li>

		<p style="text-align: right; margin-top: 2em;">
			<a href="refallocref.html"><img alt="_" src="next.png" /></a>
		</p>
	
	</div>
	</body>
</html>