<html>
<head>
	<meta content="text/html; charset=UTF-8" http-equiv="content-type">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="standard.css" />
<title>Cone - Other Distinctive Features</title>
</head>
<body>
	<div id="header">
		<div class="column">
		<a href="/">
			<img src="pegicon.png" width="56" height="56" alt="logo">
		</a>
		</div>
		<span id="title">Cone</span>
		<span id="sub">Other Distinctive Features</span></div>
		<div class="column flow-opposite">
	</div>

	<div class="text">
	
	
	<p><b>With blocks</b></p>
	<p>'with' blocks are one of Cone's more distinctive features.
	They make it possible to create declarative-looking code blocks that
	concisely build or manipulate complex data collections (such as 3D content).</p>
	<p>A 'with' block starts with an expression which establishes the value/collection to focus on.
	Throughout the course of the block, the pseudo-variable <span class="pre">this</span>
	refers to that value. More importantly, the dot ('.') and '&lt;-' operators
	can implicitly refer to <span class="pre">this</span>:</p>
<pre>
// A <span class="pre">with</span> block, where 'this' refers to the Frosty npc
with $.npcs["Frosty"]:
    with .inventory: // work with Frosty's inventory ..
        &lt;- magnifying_glass  // add to the inventory
        &lt;- cowboy_hat
	.size *= .reducer   // equivalent to: this.size = this.size * this.reducer
	with .dictionary: // work with Frosty's dictionary
		.["carrot"]: "wortel"  // add a word and its translation
    .["coal"]: "steenkool"
  .jump(2.0)          // equivalent to: this.jump(2.0) 
</pre>
	<p>Although 'with' blocks can sometimes resemble and act like method cascades,
	  Cone's 'with' block mechanism is considerably more versatile and flexible.
	In human conversations, we regularly use pronouns like "it" or "we" as placeholders 
	to refer to something specific within the context of each conversation. 
	Such pronouns make conversations pithier and less stilted.
	'this' plays a similar role in Cone programs.</p>
	<p>When used in conjunction with significant indentation,
	'with' blocks make it possible for Cone, as a procedural language,
	to express and work with content as concisely and declaratively as any markup language.
	Furthermore, the indented, compositional structure of Cone's code greatly facilitates 
	the modular "snap-together" assembly of strings, collections, and 3D world parts.</p>
	
	<p><b>High-level Control Abstractions</b></p>
	<p>Although <span class="pre">if</span> and <span class="pre">while</span> control structures
	offer general-purpose flexibility, there are certain control flow patterns that
	are common enough that more-concise formulations are worth baking into Cone:</p>
	<ul>
	<li><span class="pre">each</span> loops collapses the detailed mechanics of iterating over a sequence
	of values into a single line. 
	Invisible to the coder, it automates iterator creation, value binding, incrementation and destruction
	in a safe, type-generic way.</li>
	<li><span class="pre">match</span> collapses the detailed mechanics of matching a single value
	to a sequence of patterns in a type-generic way. Key to its simplicity is the ability to safely
	bind extracted contents from any successful matches.</li>
	<li>RAII and move semantics collapses the detailed mechanics of ensuring that allocated
	resources are safely disposed of at the end of their lexical lifetime, avoiding the need
	for explicit invocation of finalizers and free logic.</li>
	<li><span class="pre">panic</span> collapses the detailed mechanics of safely handling exception
	conditions, providing a fast path to the exit door that ensures open resources have been successfully
	disposed of.</li>
	</ul>

	
	<p><b>Tuples</b></p>
	<p>Tuples (ad hoc structs) greatly improve the convenience of working with multiple values simultaneously.
	Implicit use of tuples avoids the code overhead involved with declaring the data structure
	and then individually moving around (destructuring) each element of the tuple.
	Important use cases for tuples are parallel assignment, multiple return values and
	marshalling queued-messaging data for use by a thread or actor.</p>
<pre>
a,b = b,a                      // parallel assignment used to swap values
success, result = action(val)  // multiple return values
</pre>

	
	</div>

</body>
</html>
